{"version":3,"file":"AssignmentForm-BrPYvlzm.js","sources":["../../../../frontend/src/pages/AssignmentForm.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<div class=\"space-x-2\">\n\t\t\t<router-link\n\t\t\t\tv-if=\"assignment.doc?.name\"\n\t\t\t\t:to=\"{\n\t\t\t\t\tname: 'AssignmentSubmissionList',\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tassignmentID: assignment.doc.name,\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<Button>\n\t\t\t\t\t{{ __('Submission List') }}\n\t\t\t\t</Button>\n\t\t\t</router-link>\n\t\t\t<Button variant=\"solid\" @click=\"saveAssignment()\">\n\t\t\t\t{{ __('Save') }}\n\t\t\t</Button>\n\t\t</div>\n\t</header>\n\t<div class=\"w-3/4 mx-auto py-5\">\n\t\t<div class=\"font-semibold mb-4\">\n\t\t\t{{ __('Details') }}\n\t\t</div>\n\t\t<div class=\"grid grid-cols-2 gap-5 mt-4 mb-8\">\n\t\t\t<FormControl\n\t\t\t\tv-model=\"model.title\"\n\t\t\t\t:label=\"__('Title')\"\n\t\t\t\t:required=\"true\"\n\t\t\t/>\n\t\t\t<FormControl\n\t\t\t\tv-model=\"model.type\"\n\t\t\t\ttype=\"select\"\n\t\t\t\t:options=\"assignmentOptions\"\n\t\t\t\t:label=\"__('Type')\"\n\t\t\t\t:required=\"true\"\n\t\t\t/>\n\t\t</div>\n\t\t<div>\n\t\t\t<div class=\"text-xs text-ink-gray-5 mb-2\">\n\t\t\t\t{{ __('Question') }}\n\t\t\t\t<span class=\"text-ink-red-3\">*</span>\n\t\t\t</div>\n\t\t\t<TextEditor\n\t\t\t\t:content=\"model.question\"\n\t\t\t\t@change=\"(val) => (model.question = val)\"\n\t\t\t\t:editable=\"true\"\n\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tButton,\n\tcreateDocumentResource,\n\tcreateResource,\n\tFormControl,\n\tTextEditor,\n} from 'frappe-ui'\nimport {\n\tcomputed,\n\tinject,\n\tonMounted,\n\tonBeforeUnmount,\n\treactive,\n\twatch,\n} from 'vue'\nimport { showToast } from '@/utils'\nimport { useRouter } from 'vue-router'\n\nconst user = inject('$user')\nconst router = useRouter()\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst model = reactive({\n\ttitle: '',\n\ttype: 'PDF',\n\tquestion: '',\n})\n\nonMounted(() => {\n\tif (\n\t\tprops.assignmentID == 'new' &&\n\t\t!user.data?.is_moderator &&\n\t\t!user.data?.is_instructor\n\t) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\tif (props.assignmentID !== 'new') {\n\t\tassignment.reload()\n\t}\n\twindow.addEventListener('keydown', keyboardShortcut)\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsaveAssignment()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst assignment = createDocumentResource({\n\tdoctype: 'LMS Assignment',\n\tname: props.assignmentID,\n\tauto: false,\n})\n\nconst newAssignment = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'LMS Assignment',\n\t\t\t\t...values,\n\t\t\t},\n\t\t}\n\t},\n\tonSuccess(data) {\n\t\trouter.push({ name: 'AssignmentForm', params: { assignmentID: data.name } })\n\t},\n\tonError(err) {\n\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t},\n})\n\nconst saveAssignment = () => {\n\tif (props.assignmentID == 'new') {\n\t\tnewAssignment.submit({\n\t\t\t...model,\n\t\t})\n\t} else {\n\t\tassignment.setValue.submit(\n\t\t\t{\n\t\t\t\t...model,\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tshowToast(__('Success'), __('Assignment saved successfully'), 'check')\n\t\t\t\t\tassignment.reload()\n\t\t\t\t},\n\t\t\t\tonError(err) {\n\t\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t}\n}\n\nwatch(assignment, () => {\n\tObject.keys(assignment.doc).forEach((key) => {\n\t\tmodel[key] = assignment.doc[key]\n\t})\n})\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: __('Assignments'),\n\t\troute: { name: 'Assignments' },\n\t},\n\t{\n\t\tlabel: assignment.doc ? assignment.doc.title : __('New Assignment'),\n\t},\n])\n\nconst assignmentOptions = computed(() => {\n\treturn [\n\t\t{ label: 'PDF', value: 'PDF' },\n\t\t{ label: 'Image', value: 'Image' },\n\t\t{ label: 'Document', value: 'Document' },\n\t\t{ label: 'Text', value: 'Text' },\n\t\t{ label: 'URL', value: 'URL' },\n\t]\n})\n</script>\n"],"names":["user","inject","router","useRouter","props","__props","model","reactive","onMounted","_a","_b","assignment","keyboardShortcut","saveAssignment","onBeforeUnmount","createDocumentResource","newAssignment","createResource","values","__spreadValues","data","err","showToast","watch","key","breadcrumbs","computed","assignmentOptions"],"mappings":"48BA6EA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAASC,EAAS,EAElBC,EAAQC,EAORC,EAAQC,EAAS,CACtB,MAAO,GACP,KAAM,MACN,SAAU,EACX,CAAC,EAEDC,EAAU,IAAM,SAEdJ,EAAM,cAAgB,OACtB,GAACK,EAAAT,EAAK,OAAL,MAAAS,EAAW,eACZ,GAACC,EAAAV,EAAK,OAAL,MAAAU,EAAW,gBAEZR,EAAO,KAAK,CAAE,KAAM,SAAW,CAAA,EAE5BE,EAAM,eAAiB,OAC1BO,EAAW,OAAM,EAElB,OAAO,iBAAiB,UAAWC,CAAgB,CACpD,CAAC,EAED,MAAMA,EAAoB,GAAM,CAC3B,EAAE,MAAQ,MAAQ,EAAE,SAAW,EAAE,WACpCC,EAAc,EACd,EAAE,eAAc,EAElB,EAEAC,EAAgB,IAAM,CACrB,OAAO,oBAAoB,UAAWF,CAAgB,CACvD,CAAC,EAED,MAAMD,EAAaI,EAAuB,CACzC,QAAS,iBACT,KAAMX,EAAM,aACZ,KAAM,EACP,CAAC,EAEKY,EAAgBC,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,IAAKC,EAAA,CACJ,QAAS,kBACND,EAEP,CACE,EACD,UAAUE,EAAM,CACflB,EAAO,KAAK,CAAE,KAAM,iBAAkB,OAAQ,CAAE,aAAckB,EAAK,KAAQ,CAAA,CAC3E,EACD,QAAQC,EAAK,OACZC,EAAU,GAAG,OAAO,EAAG,KAAGb,EAAAY,EAAI,WAAJ,YAAAZ,EAAe,KAAMY,CAAG,EAAG,GAAG,CACxD,CACF,CAAC,EAEKR,EAAiB,IAAM,CACxBT,EAAM,cAAgB,MACzBY,EAAc,OAAOG,EAAA,GACjBb,EACH,EAEDK,EAAW,SAAS,OACnBQ,EAAA,GACIb,GAEJ,CACC,UAAUc,EAAM,CACfE,EAAU,GAAG,SAAS,EAAG,GAAG,+BAA+B,EAAG,OAAO,EACrEX,EAAW,OAAM,CACjB,EACD,QAAQU,EAAK,OACZC,EAAU,GAAG,OAAO,EAAG,KAAGb,EAAAY,EAAI,WAAJ,YAAAZ,EAAe,KAAMY,CAAG,EAAG,GAAG,CACxD,CACL,CACA,CAEA,EAEAE,EAAMZ,EAAY,IAAM,CACvB,OAAO,KAAKA,EAAW,GAAG,EAAE,QAASa,GAAQ,CAC5ClB,EAAMkB,CAAG,EAAIb,EAAW,IAAIa,CAAG,CAC/B,CAAA,CACF,CAAC,EAED,MAAMC,EAAcC,EAAS,IAAM,CAClC,CACC,MAAO,GAAG,aAAa,EACvB,MAAO,CAAE,KAAM,aAAe,CAC9B,EACD,CACC,MAAOf,EAAW,IAAMA,EAAW,IAAI,MAAQ,GAAG,gBAAgB,CAClE,CACF,CAAC,EAEKgB,EAAoBD,EAAS,IAC3B,CACN,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,QAAS,MAAO,OAAS,EAClC,CAAE,MAAO,WAAY,MAAO,UAAY,EACxC,CAAE,MAAO,OAAQ,MAAO,MAAQ,EAChC,CAAE,MAAO,MAAO,MAAO,KAAO,CAChC,CACC"}