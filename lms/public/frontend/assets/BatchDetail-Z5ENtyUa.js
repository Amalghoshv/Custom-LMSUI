import{F as M,f as S,j as $,d as p,ay as L,G as l,H as c,x as n,z as e,J as i,v,a5 as N,I as o,C as a,y as f,K as k,aG as V,B as j,L as C,M as D}from"./frappe-ui-2-dobwEi.js";import{n as G,B as T,l as z,m as y,G as O,s as E,b as F}from"./index-Dg_4Jaqk.js";import{_ as I}from"./CourseCard-BgWpu12I.js";import{_ as H}from"./DateRange-t2dZCPMC.js";import{_ as R}from"./CourseInstructors-EkUm29JR.js";import{_ as P}from"./UserAvatar-B6Y_HQLv.js";const q={key:0,class:"border-2 rounded-md p-5 lg:w-72"},J={key:0,class:"text-xs bg-green-200 text-green-800 float-right px-2 py-0.5 rounded-md"},K={key:0},Y={key:1},A={key:1,class:"text-xs bg-red-200 text-red-900 float-right px-2 py-0.5 rounded-md"},Q={key:2,class:"text-lg font-semibold mb-3 text-ink-gray-9"},U={class:"flex items-center mb-3 text-ink-gray-7"},W={class:"flex items-center mb-3 text-ink-gray-7"},X={key:3,class:"flex items-center text-ink-gray-7"},Z={__name:"BatchOverlay",props:{batch:{type:Object,default:null}},setup(r){const x=M(),b=S("$user"),t=r,w=$({url:"lms.lms.utils.enroll_in_batch",makeParams(s){return{batch:t.batch.data.name}}}),B=()=>{b.data||(window.location.href=`/login?redirect-to=/batches/details/${t.batch.data.name}`),w.submit({},{onSuccess(s){E(__("Success"),__("You have been enrolled in this batch"),"check"),x.push({name:"Batch",params:{batchName:t.batch.data.name}})}})},g=p(()=>{var s,m,u,_;return(s=t.batch.data)!=null&&s.seat_count?((m=t.batch.data)==null?void 0:m.seat_count)-((_=(u=t.batch.data)==null?void 0:u.students)==null?void 0:_.length):null}),d=p(()=>{var s,m,u;return(u=(s=t.batch.data)==null?void 0:s.students)==null?void 0:u.includes((m=b.data)==null?void 0:m.name)}),h=p(()=>{var s;return(s=b.data)==null?void 0:s.is_moderator});return(s,m)=>{const u=L("router-link");return r.batch.data?(n(),l("div",q,[r.batch.data.seat_count&&g.value>0?(n(),l("div",J,[N(o(g.value)+" ",1),g.value>1?(n(),l("span",K,o(s.__("Seats Left")),1)):g.value==1?(n(),l("span",Y,o(s.__("Seat Left")),1)):c("",!0)])):r.batch.data.seat_count&&g.value<=0?(n(),l("div",A,o(s.__("Sold Out")),1)):c("",!0),r.batch.data.amount?(n(),l("div",Q,o(a(G)(r.batch.data.amount,r.batch.data.currency)),1)):c("",!0),e("div",U,[i(a(T),{class:"h-4 w-4 stroke-1.5 mr-2"}),e("span",null,o(r.batch.data.courses.length)+" "+o(s.__("Courses")),1)]),i(H,{startDate:r.batch.data.start_date,endDate:r.batch.data.end_date,class:"mb-3"},null,8,["startDate","endDate"]),e("div",W,[i(a(z),{class:"h-4 w-4 stroke-1.5 mr-2"}),e("span",null,o(a(y)(r.batch.data.start_time))+" - "+o(a(y)(r.batch.data.end_time)),1)]),r.batch.data.timezone?(n(),l("div",X,[i(a(O),{class:"h-4 w-4 stroke-1.5 mr-2"}),e("span",null,o(r.batch.data.timezone),1)])):c("",!0),h.value||d.value?(n(),v(u,{key:4,to:{name:"Batch",params:{batchName:r.batch.data.name}}},{default:f(()=>[i(a(k),{variant:"solid",class:"w-full mt-4"},{default:f(()=>[e("span",null,o(h.value?s.__("Manage Batch"):s.__("Visit Batch")),1)]),_:1})]),_:1},8,["to"])):r.batch.data.paid_batch&&r.batch.data.seats_left?(n(),v(u,{key:5,to:{name:"Billing",params:{type:"batch",name:r.batch.data.name}}},{default:f(()=>[d.value?c("",!0):(n(),v(a(k),{key:0,class:"w-full mt-4",variant:"solid"},{default:f(()=>[e("span",null,o(s.__("Register Now")),1)]),_:1}))]),_:1},8,["to"])):r.batch.data.allow_self_enrollment&&r.batch.data.seats_left?(n(),v(a(k),{key:6,variant:"solid",class:"w-full mt-2",onClick:m[0]||(m[0]=_=>B())},{default:f(()=>[N(o(s.__("Enroll Now")),1)]),_:1})):c("",!0),h.value?(n(),v(u,{key:7,to:{name:"BatchForm",params:{batchName:r.batch.data.name}}},{default:f(()=>[i(a(k),{class:"w-full mt-2"},{default:f(()=>[e("span",null,o(s.__("Edit")),1)]),_:1})]),_:1},8,["to"])):c("",!0)])):c("",!0)}}},tt={key:0,class:""},at={class:"sticky top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},et={class:"m-5 pb-10"},st={class:"text-3xl font-semibold text-ink-gray-9"},rt={class:"my-3 leading-6 text-ink-gray-7"},nt={class:"flex flex-col gap-2 lg:gap-0 lg:flex-row lg:items-center justify-between lg:w-1/2"},ot={class:"flex items-center text-ink-gray-7"},lt={key:0,class:"hidden lg:block"},ct={key:1,class:"hidden lg:block"},dt={class:"flex items-center text-ink-gray-7"},it={class:"flex avatar-group overlap mt-3"},ut={class:"grid lg:grid-cols-[60%,20%] gap-4 lg:gap-20 mt-10"},mt={class:"order-2 lg:order-none"},ht=["innerHTML"],_t={class:"order-1 lg:order-none"},bt={key:0},ft={class:"flex items-center mt-10"},gt={class:"text-2xl font-semibold"},vt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mt-5"},pt={key:0},kt=["innerHTML"],Ct={__name:"BatchDetail",props:{batchName:{type:String,required:!0}},setup(r){S("$user");const x=M(),b=r,t=$({url:"lms.lms.utils.get_batch_details",cache:["batch",b.batchName],params:{batch:b.batchName},auto:!0,onSuccess:d=>{d||x.push({name:"Batches"})}}),w=$({url:"lms.lms.utils.get_batch_courses",params:{batch:b.batchName},cache:["batchCourses",b.batchName],auto:!0}),B=p(()=>{var h,s;let d=[{label:"Batches",route:{name:"Batches"}}];return d.push({label:(h=t==null?void 0:t.data)==null?void 0:h.title,route:{name:"BatchDetail",params:{batchName:(s=t==null?void 0:t.data)==null?void 0:s.name}}}),d}),g=p(()=>{var d,h;return{title:(d=t.data)==null?void 0:d.title,description:(h=t.data)==null?void 0:h.description}});return F(g),(d,h)=>{var m,u;const s=L("router-link");return a(t).data?(n(),l("div",tt,[e("header",at,[i(a(V),{items:B.value},null,8,["items"])]),e("div",et,[e("div",null,[e("div",st,o(a(t).data.title),1),e("div",rt,o(a(t).data.description),1),e("div",nt,[e("div",ot,[i(a(T),{class:"h-4 w-4 mr-2"}),e("span",null,o((u=(m=a(t).data)==null?void 0:m.courses)==null?void 0:u.length)+" "+o(d.__("Courses")),1)]),a(t).data.courses?(n(),l("span",lt,"·")):c("",!0),i(H,{startDate:a(t).data.start_date,endDate:a(t).data.end_date},null,8,["startDate","endDate"]),a(t).data.start_date?(n(),l("span",ct,"·")):c("",!0),e("div",dt,[i(a(z),{class:"h-4 w-4 mr-2"}),e("span",null,o(a(y)(a(t).data.start_time))+" - "+o(a(y)(a(t).data.end_time)),1)])]),e("div",it,[e("div",{class:j(["h-6 mr-1",{"avatar-group overlap":a(t).data.instructors.length>1}])},[(n(!0),l(C,null,D(a(t).data.instructors,_=>(n(),v(P,{user:_},null,8,["user"]))),256))],2),i(R,{instructors:a(t).data.instructors},null,8,["instructors"])])]),e("div",ut,[e("div",mt,[e("div",{class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-6",innerHTML:a(t).data.batch_details},null,8,ht)]),e("div",_t,[i(Z,{batch:a(t)},null,8,["batch"])])]),a(t).data.courses.length?(n(),l("div",bt,[e("div",ft,[e("div",gt,o(d.__("Courses")),1)]),e("div",vt,[a(t).data.courses?(n(!0),l(C,{key:0},D(a(w).data,_=>(n(),l("div",{key:_.course},[i(s,{to:{name:"CourseDetail",params:{courseName:_.name}}},{default:f(()=>[(n(),v(I,{course:_,key:_.name},null,8,["course"]))]),_:2},1032,["to"])]))),128)):c("",!0)]),a(t).data.batch_details_raw?(n(),l("div",pt,[e("div",{innerHTML:a(t).data.batch_details_raw,class:"batch-description"},null,8,kt)])):c("",!0)])):c("",!0)])])):c("",!0)}}};export{Ct as default};
//# sourceMappingURL=BatchDetail-Z5ENtyUa.js.map
