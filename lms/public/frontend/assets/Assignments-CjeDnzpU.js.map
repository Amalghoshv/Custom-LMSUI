{"version":3,"file":"Assignments-CjeDnzpU.js","sources":["../../../../frontend/src/pages/Assignments.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<router-link\n\t\t\t:to=\"{\n\t\t\t\tname: 'AssignmentForm',\n\t\t\t\tparams: {\n\t\t\t\t\tassignmentID: 'new',\n\t\t\t\t},\n\t\t\t}\"\n\t\t>\n\t\t\t<Button variant=\"solid\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<Plus class=\"w-4 h-4\" />\n\t\t\t\t</template>\n\t\t\t\t{{ __('New') }}\n\t\t\t</Button>\n\t\t</router-link>\n\t</header>\n\n\t<div class=\"md:w-3/4 md:mx-auto py-5 mx-5\">\n\t\t<div class=\"grid grid-cols-3 gap-5 mb-5\">\n\t\t\t<FormControl v-model=\"titleFilter\" :placeholder=\"__('Search by title')\" />\n\t\t\t<FormControl\n\t\t\t\tv-model=\"typeFilter\"\n\t\t\t\ttype=\"select\"\n\t\t\t\t:options=\"assignmentTypes\"\n\t\t\t\t:placeholder=\"__('Type')\"\n\t\t\t/>\n\t\t</div>\n\t\t<ListView\n\t\t\tv-if=\"assignments.data?.length\"\n\t\t\t:columns=\"assignmentColumns\"\n\t\t\t:rows=\"assignments.data\"\n\t\t\trow-key=\"name\"\n\t\t\t:options=\"{\n\t\t\t\tshowTooltip: false,\n\t\t\t\tselectable: false,\n\t\t\t\tgetRowRoute: (row) => ({\n\t\t\t\t\tname: 'AssignmentForm',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tassignmentID: row.name,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t}\"\n\t\t>\n\t\t</ListView>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2\"\n\t\t>\n\t\t\t<Pencil class=\"size-10 mx-auto stroke-1 text-ink-gray-4\" />\n\t\t\t<div class=\"text-xl font-medium\">\n\t\t\t\t{{ __('No assignments found') }}\n\t\t\t</div>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'You have not created any assignments yet. To create a new assignment, click on the \"New\" button above.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tv-if=\"assignments.data && assignments.hasNextPage\"\n\t\t\tclass=\"flex justify-center my-5\"\n\t\t>\n\t\t\t<Button @click=\"assignments.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tButton,\n\tcreateListResource,\n\tFormControl,\n\tListView,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { Plus, Pencil } from 'lucide-vue-next'\nimport { useRouter } from 'vue-router'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst titleFilter = ref('')\nconst typeFilter = ref('')\nconst router = useRouter()\n\nonMounted(() => {\n\tif (!user.data?.is_moderator && !user.data?.is_instructor) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\n\ttitleFilter.value = router.currentRoute.value.query.title\n\ttypeFilter.value = router.currentRoute.value.query.type\n})\n\nwatch([titleFilter, typeFilter], () => {\n\trouter.push({\n\t\tquery: {\n\t\t\ttitle: titleFilter.value,\n\t\t\ttype: typeFilter.value,\n\t\t},\n\t})\n\treloadAssignments()\n})\n\nconst reloadAssignments = () => {\n\tassignments.update({\n\t\tfilters: assignmentFilter.value,\n\t})\n\tassignments.reload()\n}\n\nconst assignmentFilter = computed(() => {\n\tlet filters = {}\n\tif (titleFilter.value) {\n\t\tfilters.title = ['like', `%${titleFilter.value}%`]\n\t}\n\tif (typeFilter.value) {\n\t\tfilters.type = typeFilter.value\n\t}\n\tif (!user.data?.is_moderator) {\n\t\tfilters.owner = user.data?.email\n\t}\n\treturn filters\n})\n\nconst assignments = createListResource({\n\tdoctype: 'LMS Assignment',\n\tfields: ['name', 'title', 'type', 'creation'],\n\torderBy: 'modified desc',\n\tcache: ['assignments'],\n\ttransform(data) {\n\t\treturn data.map((row) => {\n\t\t\treturn {\n\t\t\t\t...row,\n\t\t\t\tcreation: dayjs(row.creation).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\nconst assignmentColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Title'),\n\t\t\tkey: 'title',\n\t\t\twidth: 2,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Type'),\n\t\t\tkey: 'type',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Created'),\n\t\t\tkey: 'creation',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t},\n\t]\n})\n\nconst assignmentTypes = computed(() => {\n\tlet types = ['', 'Document', 'Image', 'PDF', 'URL', 'Text']\n\treturn types.map((type) => {\n\t\treturn {\n\t\t\tlabel: __(type),\n\t\t\tvalue: type,\n\t\t}\n\t})\n})\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: 'Assignments',\n\t\troute: { name: 'Assignments' },\n\t},\n])\n</script>\n"],"names":["user","inject","dayjs","titleFilter","ref","typeFilter","router","useRouter","onMounted","_a","_b","watch","reloadAssignments","assignments","assignmentFilter","computed","filters","createListResource","data","row","__spreadProps","__spreadValues","assignmentColumns","assignmentTypes","type","breadcrumbs"],"mappings":"wkCAuFA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAAQD,EAAO,QAAQ,EACvBE,EAAcC,EAAI,EAAE,EACpBC,EAAaD,EAAI,EAAE,EACnBE,EAASC,EAAS,EAExBC,EAAU,IAAM,SACX,GAACC,EAAAT,EAAK,OAAL,MAAAS,EAAW,eAAgB,GAACC,EAAAV,EAAK,OAAL,MAAAU,EAAW,gBAC3CJ,EAAO,KAAK,CAAE,KAAM,SAAW,CAAA,EAGhCH,EAAY,MAAQG,EAAO,aAAa,MAAM,MAAM,MACpDD,EAAW,MAAQC,EAAO,aAAa,MAAM,MAAM,IACpD,CAAC,EAEDK,EAAM,CAACR,EAAaE,CAAU,EAAG,IAAM,CACtCC,EAAO,KAAK,CACX,MAAO,CACN,MAAOH,EAAY,MACnB,KAAME,EAAW,KACjB,CACD,CAAA,EACDO,EAAiB,CAClB,CAAC,EAED,MAAMA,EAAoB,IAAM,CAC/BC,EAAY,OAAO,CAClB,QAASC,EAAiB,KAC1B,CAAA,EACDD,EAAY,OAAM,CACnB,EAEMC,EAAmBC,EAAS,IAAM,SACvC,IAAIC,EAAU,CAAA,EACd,OAAIb,EAAY,QACfa,EAAQ,MAAQ,CAAC,OAAQ,IAAIb,EAAY,KAAK,GAAG,GAE9CE,EAAW,QACdW,EAAQ,KAAOX,EAAW,QAEtBI,EAAAT,EAAK,OAAL,MAAAS,EAAW,eACfO,EAAQ,OAAQN,EAAAV,EAAK,OAAL,YAAAU,EAAW,OAErBM,CACR,CAAC,EAEKH,EAAcI,EAAmB,CACtC,QAAS,iBACT,OAAQ,CAAC,OAAQ,QAAS,OAAQ,UAAU,EAC5C,QAAS,gBACT,MAAO,CAAC,aAAa,EACrB,UAAUC,EAAM,CACf,OAAOA,EAAK,IAAKC,GACTC,EAAAC,EAAA,GACHF,GADG,CAEN,SAAUjB,EAAMiB,EAAI,QAAQ,EAAE,QAAS,CAC3C,EACG,CACD,CACF,CAAC,EAEKG,EAAoBP,EAAS,IAC3B,CACN,CACC,MAAO,GAAG,OAAO,EACjB,IAAK,QACL,MAAO,CACP,EACD,CACC,MAAO,GAAG,MAAM,EAChB,IAAK,OACL,MAAO,EACP,MAAO,MACP,EACD,CACC,MAAO,GAAG,SAAS,EACnB,IAAK,WACL,MAAO,EACP,MAAO,QACP,CACH,CACC,EAEKQ,EAAkBR,EAAS,IACpB,CAAC,GAAI,WAAY,QAAS,MAAO,MAAO,MAAM,EAC7C,IAAKS,IACV,CACN,MAAO,GAAGA,CAAI,EACd,MAAOA,CACV,EACE,CACD,EAEKC,EAAcV,EAAS,IAAM,CAClC,CACC,MAAO,cACP,MAAO,CAAE,KAAM,aAAe,CAC9B,CACF,CAAC"}