import{aq as F,r as z,ar as D,f as M,j,v as C,x as d,y as p,z as s,G as _,I as i,J as l,C as e,a9 as q,K as w,a5 as S,q as B,d as N,H as k,aG as R,i as Y,ay as E}from"./frappe-ui-2-dobwEi.js";import{$ as H,a0 as G,e as U,b as O,ac as I,ad as K,a8 as Q,a9 as W,ae as X,af as Z,ag as ee}from"./index-Dg_4Jaqk.js";const se={class:"flex flex-col gap-4"},te={key:0},ae={class:""},oe={key:1,class:"flex items-center"},ie={class:"border rounded-md p-2 mr-2"},le={class:"flex flex-col"},ne={class:"text-sm text-ink-gray-4 mt-1"},re={__name:"JobApplicationModal",props:F({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(f){const r=z(null),y=D(f,"modelValue"),x=M("$user"),v=D(f,"application"),o=f,u=c=>{if(c.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},b=j({url:"frappe.client.insert",makeParams(c){var n,t;return{doc:{doctype:"LMS Job Application",user:(n=x.data)==null?void 0:n.name,resume:(t=r.value)==null?void 0:t.file_name,job:o.job}}}}),$=c=>{b.submit({},{validate(){if(!r.value)return"Please upload your resume"},onSuccess(){U({title:"Success",text:"Your application has been submitted",icon:"check",iconClasses:"bg-surface-green-3 text-ink-white rounded-md p-px"}),v.value.reload(),c()},onError(n){var t;U({title:"Error",text:((t=n.messages)==null?void 0:t[0])||n,icon:"x",iconClasses:"bg-surface-red-5 text-ink-white rounded-md p-px",position:"top-center",timeout:10})}})};return(c,n)=>(d(),C(e(B),{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=t=>y.value=t),class:"text-base",options:{title:c.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:t=>{$(t)}}]}},{"body-content":p(()=>[s("div",se,[s("p",null,i(c.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),r.value?(d(),_("div",oe,[s("div",ie,[l(e(H),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),s("div",le,[s("span",null,i(r.value.file_name),1),s("span",ne,i(e(G)(r.value.file_size)),1)])])):(d(),_("div",te,[l(e(q),{fileTypes:[".pdf"],validateFile:u,onSuccess:n[0]||(n[0]=t=>{r.value=t})},{default:p(({file:t,progress:a,uploading:m,openFileSelector:g})=>[s("div",ae,[l(e(w),{onClick:g,loading:m},{default:p(()=>[S(i(m?`Uploading ${a}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},de={class:""},ce={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},pe={key:0,class:"flex"},ue={key:1},me={key:0,class:"max-w-3xl mx-auto"},_e={class:"p-4"},fe={class:"space-y-5 mb-10"},xe={class:"flex items-center"},be=["src","alt"],he={class:"text-2xl text-ink-gray-9 font-semibold mb-4"},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-5 md:gap-y-5"},ve={class:"flex items-center space-x-4"},ge={class:"flex flex-col space-y-2 text-ink-gray-7"},ke={class:"text-xs text-ink-gray-5 font-medium uppercase"},je={class:"text-sm font-semibold"},we={class:"flex items-center space-x-4"},$e={class:"flex flex-col space-y-2 text-ink-gray-7"},Me={class:"text-xs font-medium uppercase"},Ce={class:"text-sm font-semibold"},Se={class:"flex items-center space-x-4"},Ve={class:"flex flex-col space-y-2 text-ink-gray-7"},Ae={class:"text-xs font-medium uppercase"},Je={class:"text-sm font-semibold"},Le={class:"flex items-center space-x-4"},Pe={class:"flex flex-col space-y-2 text-ink-gray-7"},Te={class:"text-xs font-medium uppercase"},De={class:"text-sm font-semibold"},Ue={key:0,class:"flex items-center space-x-4"},ze={class:"flex flex-col space-y-2 text-ink-gray-7"},Fe={class:"text-xs font-medium uppercase"},qe={class:"text-sm font-semibold"},Be=["innerHTML"],Ye={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(f){const r=M("$user"),y=M("$dayjs"),x=z(!1),v=f,o=j({url:"lms.lms.api.get_job_details",params:{job:v.job},cache:["job",v.job],auto:!0,onSuccess:t=>{var a;(a=r.data)!=null&&a.name&&u.submit(),b.submit()}}),u=j({url:"frappe.client.get_list",makeParams(t){var a,m;return{doctype:"LMS Job Application",filters:{job:(a=o.data)==null?void 0:a.name,user:(m=r.data)==null?void 0:m.name}}}}),b=j({url:"frappe.client.get_count",makeParams(t){var a;return{doctype:"LMS Job Application",filters:{job:(a=o.data)==null?void 0:a.name}}}}),$=()=>{x.value=!0},c=t=>{window.location.href=`/login?redirect-to=/job-openings/${t}`},n=N(()=>{var t,a;return{title:(t=o.data)==null?void 0:t.job_title,description:(a=o.data)==null?void 0:a.description}});return O(n),(t,a)=>{var g,V,A,J,L,P;const m=E("router-link");return d(),_("div",de,[s("header",ce,[l(e(R),{class:"h-7",items:[{label:t.__("Jobs"),route:{name:"Jobs"}},{label:(g=e(o).data)==null?void 0:g.job_title,route:{name:"JobDetail",params:{job:(V=e(o).data)==null?void 0:V.name}}}]},null,8,["items"]),(A=e(r).data)!=null&&A.name?(d(),_("div",pe,[e(r).data.name==((J=e(o).data)==null?void 0:J.owner)?(d(),C(m,{key:0,to:{name:"JobCreation",params:{jobName:(L=e(o).data)==null?void 0:L.name}}},{default:p(()=>[l(e(w),{class:"mr-2"},{prefix:p(()=>[l(e(I),{class:"h-4 w-4 stroke-1.5"})]),default:p(()=>[S(" "+i(t.__("Edit")),1)]),_:1})]),_:1},8,["to"])):k("",!0),(P=e(u).data)!=null&&P.length?k("",!0):(d(),C(e(w),{key:1,variant:"solid",onClick:a[0]||(a[0]=h=>$())},{prefix:p(()=>[l(e(K),{class:"h-4 w-4"})]),default:p(()=>[S(" "+i(t.__("Apply")),1)]),_:1}))])):(d(),_("div",ue,[l(e(w),{onClick:a[1]||(a[1]=h=>{var T;return c((T=e(o).data)==null?void 0:T.name)})},{default:p(()=>[s("span",null,i(t.__("Login to apply")),1)]),_:1})]))]),e(o).data?(d(),_("div",me,[s("div",_e,[s("div",fe,[s("div",xe,[s("img",{src:e(o).data.company_logo,class:"w-16 h-16 rounded-lg object-contain mr-4",alt:e(o).data.company_name},null,8,be),s("div",he,i(e(o).data.job_title),1)]),s("div",null,[s("div",ye,[s("div",ve,[l(e(Q),{class:"h-4 w-4 text-ink-green-2"}),s("div",ge,[s("span",ke,i(t.__("Organisation")),1),s("span",je,i(e(o).data.company_name),1)])]),s("div",we,[l(e(W),{class:"size-4 text-ink-red-3"}),s("div",$e,[s("span",Me,i(t.__("Location")),1),s("span",Ce,i(e(o).data.location),1)])]),s("div",Se,[l(e(X),{class:"h-4 w-4 text-yellow-500"}),s("div",Ve,[s("span",Ae,i(t.__("Category")),1),s("span",Je,i(e(o).data.type),1)])]),s("div",Le,[l(e(Z),{class:"h-4 w-4 text-ink-blue-2"}),s("div",Pe,[s("span",Te,i(t.__("Posted on")),1),s("span",De,i(e(y)(e(o).data.creation).format("DD MMM YYYY")),1)])]),e(b).data?(d(),_("div",Ue,[l(e(ee),{class:"h-4 w-4 text-purple-500"}),s("div",ze,[s("span",Fe,i(t.__("Applications Received")),1),s("span",qe,i(e(b).data),1)])])):k("",!0)])])]),s("p",{innerHTML:e(o).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-6"},null,8,Be)]),l(re,{modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=h=>x.value=h),application:e(u),"onUpdate:application":a[3]||(a[3]=h=>Y(u)?u.value=h:null),job:e(o).data.name},null,8,["modelValue","application","job"])])):k("",!0)])}}};export{Ye as default};
//# sourceMappingURL=JobDetail-C_-noFbd.js.map
