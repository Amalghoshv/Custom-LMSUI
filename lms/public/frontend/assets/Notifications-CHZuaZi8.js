import{r as A,s as D,f as C,F as H,at as L,d as m,j as w,G as l,z as i,J as o,C as e,aG as S,v as _,H as f,y as c,a5 as R,I as k,K as V,aL as z,L as $,M as F,x as s,as as G,b7 as E,D as I}from"./frappe-ui-2-dobwEi.js";import{b as J,a1 as K}from"./index-Dg_4Jaqk.js";const P={class:"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},X={class:"flex items-center space-x-2"},q={class:"w-3/4 mx-auto px-5 pt-6 divide-y"},O={class:"flex items-center py-2 justify-between"},Q={class:"flex items-center"},W=["innerHTML"],Y={class:"flex items-center space-x-2"},Z={key:1,class:"text-ink-gray-5"},se={__name:"Notifications",setup(ee){var x,h;const d=C("$user"),M=C("$socket"),r=A("Unread"),T=H();D(()=>{d.data||T.push({name:"Courses"}),M.on("publish_lms_notifications",a=>{n.reload()})});const p=m(()=>r.value==="Unread"?n.data:u.data),n=L({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(x=d.data)==null?void 0:x.name,read:0},auto:!0,cache:"Unread Notifications"}),u=L({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(h=d.data)==null?void 0:h.name,read:1},auto:!0,cache:"Read Notifications"}),b=w({url:"lms.lms.api.mark_as_read",makeParams(a){return{name:a.name}},onSuccess(a){n.reload(),u.reload()}}),v=w({url:"lms.lms.api.mark_all_as_read",onSuccess(a){n.reload(),u.reload()}}),U=m(()=>[{label:"Notifications",route:{name:"Notifications"}}]),j=m(()=>({title:"Notifications",description:"All your notifications in one place."}));return J(j),(a,y)=>{var g,N;return s(),l($,null,[i("header",P,[o(e(S),{items:U.value},null,8,["items"]),i("div",X,[r.value==="Unread"&&((g=e(n).data)==null?void 0:g.length)>0?(s(),_(e(V),{key:0,onClick:e(v).submit,loading:e(v).loading},{default:c(()=>[R(k(a.__("Mark all as read")),1)]),_:1},8,["onClick","loading"])):f("",!0),o(e(z),{class:"inline-block",buttons:[{label:"Unread",active:!0},{label:"Read"}],modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=t=>r.value=t)},null,8,["modelValue"])])]),i("div",q,[(N=p.value)!=null&&N.length?(s(!0),l($,{key:0},F(p.value,t=>(s(),l("div",O,[i("div",Q,[o(e(G),{image:t.user_image,label:t.full_name,class:"mr-2"},null,8,["image","label"]),i("div",{class:"notification text-ink-gray-7",innerHTML:t.subject},null,8,W)]),i("div",Y,[t.link?(s(),_(e(E),{key:0,to:t.link,onClick:B=>e(b).submit({name:t.name}),class:"text-ink-gray-5 font-medium text-sm hover:text-ink-gray-7"},{default:c(()=>[R(k(a.__("View")),1)]),_:2},1032,["to","onClick"])):f("",!0),o(e(I),{text:a.__("Mark as read")},{default:c(()=>[t.read?f("",!0):(s(),_(e(V),{key:0,variant:"ghost",onClick:B=>e(b).submit({name:t.name})},{icon:c(()=>[o(e(K),{class:"h-4 w-4 text-ink-gray-7 stroke-1.5"})]),_:2},1032,["onClick"]))]),_:2},1032,["text"])])]))),256)):(s(),l("div",Z,k(a.__("Nothing to see here.")),1))])],64)}}};export{se as default};
//# sourceMappingURL=Notifications-CHZuaZi8.js.map
